title: Exploiting Weak Credentials for Initial Access in Active Directory
id: ad_weak_credentials_detection
status: stable
description: Detects attempts to exploit weak or default credentials for initial access to Active Directory.
references:
  - Insert_References_Here
logsource:
  product: windows
  service: security
detection:
  selection:
    EventID: 4625
  condition: 
    EventID == 4625 AND
    LogonType == 3 AND
    LogonProcessName != "Advapi" AND
    (FailureReason == 0xc000006d OR FailureReason == 0xc000006e OR FailureReason == 0xc000006f OR FailureReason == 0xc0000070 OR FailureReason == 0xc0000071 OR FailureReason == 0xc0000193 OR FailureReason == 0xc0000224 OR FailureReason == 0xc00002ee) AND
    (TargetUserName == "Administrator" OR TargetUserName == "Guest" OR TargetUserName == "DefaultAccount") OR
    (FailureReason == 0xc000006a OR FailureReason == 0xc000006c) AND
    TargetUserName == "admin"
level: medium
tags:
  - attack.authentication
  - attack.t1078
  - attack.t1552
falsepositives:
  - Legitimate cases of mistyped passwords or security tools performing password-related operations.
output:
  title: Exploiting Weak Credentials Detected
  description: Unauthorized login attempts using weak or default credentials were detected.
  severity: medium
  tags:
    - attack.authentication
    - attack.t1078
    - attack.t1552
  ttp:
    - T1078: Valid Accounts
    - T1552: Unsecured Credentials
  event:
    kind: event
    category: Exploiting Weak Credentials
    description: Unauthorized login attempts with weak or default credentials detected.
    product: windows
    timestamp: "*"
    url: "*"
